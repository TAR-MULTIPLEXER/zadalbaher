<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Menu | Zad</title>
    <link rel="stylesheet" href="menu_four.css">
    <link rel="stylesheet" href="variables.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"/>   
    <link rel="icon" href="pictures/zad_al_baher-logo-tr_2.png">

    <link rel="preconnect" href="https://fonts.googleapis.com">   
    <link rel="preconnect" href="https://fonts.gstatic.com"  crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400..700&family=Parisienne&family=Nunito+Sans:ital,opsz,wght,YTLC@0,6..12,300,519;1,6..12,300,519&display=swap" rel="stylesheet">
</head>
<body>
    <header>
        <div class="separator">
            <hr class="line">
            <img src="pictures/zad_al_baher-logo-tr.png" alt="Separator Image" class="separator-image">
            <hr class="line">
        </div>
        <h2>Zad Al Baher - Restaurant</h2>
        <h1>Menu</h1>
    </header>

    <main>
        <section class="filter-buttons" id="filter-buttons">
            <!-- Buttons will be generated by JS -->
        </section>

        <section class="menu" id="menu">
            <!-- Menu sections will be generated by JS -->
        </section>

        <div class="separator">
            <hr class="line">
            <img src="pictures/zad_al_baher-logo-tr.png" alt="Separator Image" class="separator-image">
            <hr class="line">
        </div>
    </main>

    <script>
        let menuItems = [];

        // Load JSON data
        async function loadMenuData() {
            const response = await fetch('menu_data.json');
            menuItems = await response.json();
            generateFilterButtons();
            displayMenu('all');
        }

        // Generate filter buttons dynamically
        function generateFilterButtons() {
            const categories = [...new Set(menuItems.map(item => item.category))];
            const container = document.getElementById('filter-buttons');

            const allButton = document.createElement('button');
            allButton.className = 'filter-btn active';
            allButton.textContent = 'All';
            allButton.onclick = () => filterMenu('all');
            container.appendChild(allButton);

            categories.forEach(category => {
                const button = document.createElement('button');
                button.className = 'filter-btn';
                button.textContent = prettifyCategory(category);
                button.onclick = () => filterMenu(category);
                container.appendChild(button);
            });
        }

        // Display menu for selected category
        function filterMenu(category) {
            displayMenu(category);

            // Update active class on buttons
            const buttons = document.querySelectorAll('.filter-btn');
            buttons.forEach(btn => btn.classList.remove('active'));
            const activeButton = Array.from(buttons).find(btn => 
                category === 'all' ? btn.textContent === 'All' : btn.textContent === prettifyCategory(category)
            );
            if (activeButton) activeButton.classList.add('active');
        }

        // Render menu based on category
        function displayMenu(category) {
            const menuContainer = document.getElementById('menu');
            menuContainer.innerHTML = '';

            const filtered = category === 'all'
                ? menuItems
                : menuItems.filter(item => item.category === category);

            const groupedByCategory = groupBy(filtered, 'category');

            for (const [catKey, items] of Object.entries(groupedByCategory)) {
                const section = document.createElement('div');
                section.className = `menu-section ${catKey}`;

                const heading = document.createElement('h2');
                heading.textContent = prettifyCategory(catKey);
                section.appendChild(heading);

                items.forEach(item => {
                    const p = document.createElement('p');
                    p.innerHTML = `
                        <strong>${item.name}</strong>
                        <span class="description">${item.description}</span>
                        <span class="price">$${parseFloat(item.price).toFixed(2)}</span>
                    `;
                    section.appendChild(p);
                });

                menuContainer.appendChild(section);
            }
        }

        // Utility to group array by key
        function groupBy(array, key) {
            return array.reduce((result, item) => {
                (result[item[key]] = result[item[key]] || []).push(item);
                return result;
            }, {});
        }

        // Make category names human-readable
        function prettifyCategory(str) {
            const map = {
                'cold-appetizers': 'Cold Appetizers',
                'hot-appetizers': 'Hot Appetizers',
                'bbq': 'BBQ',
                'main-course': 'Main Course',
                'raw-fish': 'Raw Fish',
                'cold-beverage': 'Cold Beverage',
                'hot-beverage': 'Hot Beverage',
                'beers-arak': 'Beers & Arak',
                'argile': 'Argile',
                'desserts': 'Desserts',
                'salad': 'Salad'
            };
            return map[str] || str;
        }

        // Initial load
        loadMenuData();
    </script>
</body>
</html>